<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                             http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">

    <changeSet id="20180607_time11_59" author="devpav" runOnChange="true">
        <comment>Создание таблиц для хранения данных</comment>
        <sql>
            create table if not exists attractions
            (
            id uuid not null
            constraint attractions_pkey
            primary key,
            image varchar(255),
            link_source varchar(255),
            title varchar(255)
            )
            ;


            create table if not exists roles
            (
            id uuid not null
            constraint roles_pkey
            primary key,
            title varchar(50)
            )
            ;

            create table if not exists translate
            (
            id uuid not null
            constraint translate_pkey
            primary key
            )
            ;


            create table if not exists string_values
            (
            id uuid not null
            constraint string_values_pkey
            primary key,
            language uuid not null,
            value varchar(255) not null,
            translate_id uuid
            constraint fksnt5nmoqr6j2mjeu7ae61bc5p
            references translate
            )
            ;

            create table if not exists tags
            (
            id uuid not null
            constraint tags_pkey
            primary key,
            title uuid not null
            constraint fkcf1v0sjodvyv3kkoh42hkfxw3
            references translate
            )
            ;

            create table if not exists attraction_tag
            (
            attraction uuid not null
            constraint fkju79re617ev0f1qsahg6gypyo
            references attractions,
            tag uuid not null
            constraint fk8nsttgdubm36fkutru96bp5po
            references tags
            )
            ;

            create table if not exists type_service
            (
            id uuid not null
            constraint type_service_pkey
            primary key,
            title uuid not null
            constraint fki23eflj82kllsa94otgjvaqk
            references translate
            )
            ;


            create table if not exists products
            (
            id uuid not null
            constraint products_pkey
            primary key,
            price numeric(19,2),
            id_service uuid not null
            constraint fkb0i5sdu7n6vurqs54vqxyic2v
            references type_service,
            attraction uuid
            constraint fk7lqagw1qny7cikooc914cmi4m
            references attractions
            )
            ;

            create table if not exists types
            (
            id uuid not null
            constraint types_pkey
            primary key,
            title uuid not null
            constraint fk1cq1rf2wy2khmdaceyywkvrqb
            references translate
            )
            ;


            create table if not exists attraction_type
            (
            attraction uuid not null
            constraint fkioass2blokum8layldxs8agee
            references attractions,
            type uuid not null
            constraint fknnp7kkvsdt4v83xwdia3ojwub
            references types
            )
            ;

            create table if not exists users
            (
            id uuid not null
            constraint users_pkey
            primary key,
            email varchar(255) not null,
            enabled boolean not null,
            last_password_reset_date timestamp,
            login varchar(50) not null
            constraint uk_ow0gan20590jrb00upg3va2fn
            unique,
            password varchar(100) not null,
            phone varchar(255)
            )
            ;

            create table if not exists user_role
            (
            id_user uuid not null
            constraint fkr53t650tbjk5yipcm228wf1nc
            references users,
            id_role uuid not null
            constraint fk2yqlxhjhgilevh7qvt2ve6udh
            references roles
            )
            ;

            create table if not exists verification_tokens
            (
            id bigserial not null
            constraint verification_tokens_pkey
            primary key,
            expiration_date timestamp,
            token varchar(255),
            user_id uuid
            constraint fk54y8mqsnq1rtyf581sfmrbp4f
            references users
            )
            ;
        </sql>
    </changeSet>
</databaseChangeLog>